

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Figure generation for Invitation to the ECT &mdash; ect 0.1.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=59fadc99"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ect
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">1. Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">2. Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">3. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">4. Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">5. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">6. Citing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ect</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Figure generation for <em>Invitation to the ECT</em></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/CodingFiguresFern.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Figure-generation-for-Invitation-to-the-ECT">
<h1>Figure generation for <em>Invitation to the ECT</em><a class="headerlink" href="#Figure-generation-for-Invitation-to-the-ECT" title="Link to this heading">ÔÉÅ</a></h1>
<p>This notebook was used to generate the figures for the paper</p>
<blockquote>
<div><p>Elizabeth Munch. An Invitation to the Euler Characteristic Transform. <a class="reference external" href="https://arxiv.org/abs/2310.10395">arXiv:2310.10395</a>, 2023. To appear: MAA Monthly, 2024.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><br/><span></span>import numpy as np
import matplotlib.pyplot as plt
# import teaspoon

plt.rcParams.update({
    &quot;text.usetex&quot;: True,
    # &quot;font.family&quot;: &quot;Helvetica&quot;,
    &quot;font.family&quot;: &quot;serif&quot;,
    &quot;font.size&quot;: 8
})
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib
matplotlib.__version__
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;3.8.4&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Code to set colormaps to deal with the transparency issue

cmap_viridis = matplotlib.cm.viridis
cmap_viridis.set_bad(&#39;white&#39;,1.)


cmap_binary = matplotlib.cm.tab20b
cmap_binary.set_bad(&#39;white&#39;,1.)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>F = plt.imread(&#39;figures/leafbw.tif&#39;)
F = F.T
F = F/255.

F_finite = np.copy(F)
F_finite[F==0] = 2000

# G = np.ones_like(F)
# G[F==0] = 1
# print(G.shape)

F[F==0] = np.nan


plt.matshow(F, origin = &#39;lower&#39;,cmap = cmap_binary)
# plt.matshow(G, origin = &#39;lower&#39;)

fig = plt.gcf()
# fig.set_rasterized(True)
fig.set_figwidth(5)

plt.title(&#39;Testing&#39;)

plt.savefig(&#39;figures/test.png&#39;, dpi = 300)
plt.savefig(&#39;figures/test.eps&#39;, facecolor=&#39;white&#39;, transparent=False,bbox_inches=&#39;tight&#39;)
plt.savefig(&#39;figures/test.pdf&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_5_0.png" src="../_images/notebooks_CodingFiguresFern_5_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>F
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def makeFernPic(F, theta, plot = True):
    maxRow, maxCol = np.shape(F)
    omega = (np.cos(theta), np.sin(theta))

    # center origin
    Col,Row = np.meshgrid(range(maxCol),range(maxRow))
    Col = Col - np.floor(maxCol/2)
    Row = Row-np.floor(maxRow/2)

    fMask = omega[0]*Col + omega[1]*Row
    DT = np.multiply(F,fMask)

    return DT
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cmap = matplotlib.cm.viridis
cmap.set_bad(&#39;white&#39;,1.)

plt.matshow(makeFernPic(F,np.pi/2), origin = &#39;lower&#39;, cmap = cmap_viridis)
plt.colorbar(fraction=0.035, pad=0.04)

fig = plt.gcf()
# fig.set_rasterized(True)
fig.set_figwidth(5)

plt.savefig(&#39;figures/test.png&#39;, dpi = 300)
plt.savefig(&#39;figures/test.eps&#39;, facecolor=&#39;white&#39;, transparent=False,bbox_inches=&#39;tight&#39;)
plt.savefig(&#39;figures/test.pdf&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_9_0.png" src="../_images/notebooks_CodingFiguresFern_9_0.png" />
</div>
</div>
</section>
<section id="Trying-Erik's-stuff">
<h1>Trying Erik‚Äôs stuff<a class="headerlink" href="#Trying-Erik's-stuff" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import demeter.euler as euler
import demeter.directions as dirs
import demeter.misc as misc
import time
import tifffile as tf
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>leaf_file = &#39;figures/leafbw.tif&#39;
leaf_img = tf.imread(leaf_file)
leaf_img[leaf_img &gt; 0] = 1

fig, ax = plt.subplots(1,2,figsize=(20,6))
ax[0].imshow(leaf_img, cmap=&#39;gray&#39;);
ax[0].plot([200,200,250,250,200], [280,310,310,280,280], c=&#39;red&#39;, lw=4);
ax[1].imshow(leaf_img[280:310, 200:250], cmap=&#39;gray&#39;);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_12_0.png" src="../_images/notebooks_CodingFiguresFern_12_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>tic = time.perf_counter()
leaf = euler.CubicalComplex(leaf_img).complexify()
toc = time.perf_counter()

print(&quot;Complexify in {:.4f} seconds.\n\nCubical complex made of:&quot;.format(toc-tic))

leaf.summary();
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Complexify in 1.0271 seconds.

Cubical complex made of:
53832   vertices
99196   edges
45167   squares
----
Euler Characteristic: -197
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>leaf.summary()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
53832   vertices
99196   edges
45167   squares
----
Euler Characteristic: -197
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>leaf.cells
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[array([[-271.57746322,   89.89517387],
        [-271.57746322,   90.89517387],
        [-270.57746322,   88.89517387],
        ...,
        [ 259.42253678,  -44.10482613],
        [ 259.42253678,  -43.10482613],
        [ 260.42253678,  -45.10482613]]),
 array([[    0,     1],
        [    0,     3],
        [    1,     4],
        ...,
        [53828, 53829],
        [53828, 53831],
        [53829, 53830]]),
 array([[    0,     1,     3,     4],
        [    2,     3,     7,     8],
        [    3,     4,     8,     9],
        ...,
        [53821, 53822, 53826, 53827],
        [53825, 53826, 53828, 53829],
        [53826, 53827, 53829, 53830]])]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>theta = np.pi/4
omega = (np.cos(theta),np.sin(theta))
heights = np.sum(leaf.cells[0]*omega, axis=1)
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>heights
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-128.46877882, -127.76167204, -128.46877882, ...,  152.25261331,
        152.9597201 ,  152.25261331])
</pre></div></div>
</div>
<section id="Making-pictures">
<h2>Making pictures<a class="headerlink" href="#Making-pictures" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>theta = 6*np.pi/4
omega = (np.cos(theta), np.sin(theta))
heights = np.sum(leaf.cells[0]*omega, axis=1)
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.scatter(leaf.cells[0][:,0],leaf.cells[0][:,1],
                         s=0.1, c=heights, cmap=&#39;magma&#39;, label=&#39;T = {}&#39;.format(32))
plt.colorbar()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.colorbar.Colorbar at 0x73f180e96250&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_20_1.png" src="../_images/notebooks_CodingFiguresFern_20_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Figuring out centering
size = np.shape(F)
print(np.floor(size[0]/2))
print(np.floor(size[1]/2))
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
177.0
279.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.matshow(makeFernPic(F,theta), origin = &#39;lower&#39;, cmap = cmap_viridis, vmin = -150, vmax = 150)
ax = plt.gca()
midx = 279
ax.set_xticks(midx+100*np.arange(-2,3))
ax.set_xticklabels(np.arange(-2,3)*100)

midy = 177
ax.set_yticks(midy+100*np.arange(-2,3))
ax.set_yticklabels(np.arange(-2,3)*100)

plt.colorbar()

# plt.savefig(&#39;figures/Fern&#39; + str(int(theta*1000)) + &#39;.png&#39;, bbox_inches = &#39;tight&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.colorbar.Colorbar at 0x73f16b1855d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_22_1.png" src="../_images/notebooks_CodingFiguresFern_22_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Version without colorbars

thetaStrs = [r&#39;\pi/4&#39;, r&#39;3\pi/4&#39;, r&#39;3\pi/2&#39;, &#39;7\pi/4&#39;]
thetaStrsFile = [r&#39;pi_over_4&#39;, r&#39;3pi_over_4&#39;, r&#39;3pi_over_2&#39;, &#39;7pi_over_4&#39;]
thetas = [np.pi/4, 3*np.pi/4, 3*np.pi/2, 7*np.pi/4]


for i, theta in enumerate(thetas):
    print(theta)
    im = plt.matshow(makeFernPic(F,theta), origin = &#39;lower&#39;, cmap = cmap_viridis, vmin = -200, vmax = 200)
    ax = plt.gca()
    midx = 279
    ax.set_xticks(midx+100*np.arange(-2,3))
    ax.set_xticklabels(np.arange(-2,3)*100)
    ax.xaxis.set_ticks_position(&#39;bottom&#39;)

    midy = 177
    ax.set_yticks(midy+100*np.arange(-2,3))
    ax.set_yticklabels(np.arange(-2,3)*100)

    # plt.colorbar(fraction=0.035, pad=0.04)
    plt.title(r&#39;$f_{\omega}$ for $\omega = &#39; + thetaStrs[i] + r&#39;$&#39;)
    fig = plt.gcf()
    fig.set_figwidth(1.8)

    print(fig.get_size_inches())
    height_fig = fig.get_size_inches()[0]
    print(height_fig)

    plt.savefig(&#39;figures/Fern_&#39; + thetaStrsFile[i] + &#39;_nocolorbar.png&#39;, bbox_inches = &#39;tight&#39;, dpi = 300)
    plt.savefig(&#39;figures/Fern_&#39; + thetaStrsFile[i] + &#39;_nocolorbar.eps&#39;, bbox_inches = &#39;tight&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.7853981633974483
[1.8 4.8]
1.8
2.356194490192345
[1.8 4.8]
1.8
4.71238898038469
[1.8 4.8]
1.8
5.497787143782138
[1.8 4.8]
1.8
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_23_1.png" src="../_images/notebooks_CodingFiguresFern_23_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_23_2.png" src="../_images/notebooks_CodingFiguresFern_23_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_23_3.png" src="../_images/notebooks_CodingFiguresFern_23_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_23_4.png" src="../_images/notebooks_CodingFiguresFern_23_4.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><br/><span></span>thetaStrs = [r&#39;\pi/4&#39;, r&#39;3\pi/4&#39;, r&#39;3\pi/2&#39;, &#39;7\pi/4&#39;]
thetaStrsFile = [r&#39;pi_over_4&#39;, r&#39;3pi_over_4&#39;, r&#39;3pi_over_2&#39;, &#39;7pi_over_4&#39;]
thetas = [np.pi/4, 3*np.pi/4, 3*np.pi/2, 7*np.pi/4]


for i, theta in enumerate(thetas):
    print(theta)
    plt.matshow(makeFernPic(F,theta), origin = &#39;lower&#39;, cmap = cmap_viridis, vmin = -200, vmax = 200)
    ax = plt.gca()
    midx = 279
    ax.set_xticks(midx+100*np.arange(-2,3))
    ax.set_xticklabels(np.arange(-2,3)*100)
    ax.xaxis.set_ticks_position(&#39;bottom&#39;)

    midy = 177
    ax.set_yticks(midy+100*np.arange(-2,3))
    ax.set_yticklabels(np.arange(-2,3)*100)

    plt.colorbar(fraction=0.03, pad=0.04)
    plt.title(r&#39;$f_{\omega}$ for $\omega = &#39; + thetaStrs[i] + r&#39;$&#39;)
    fig = plt.gcf()
    # fig.set_figwidth(2.4)
    print(height_fig)
    fig.set_figheight(height_fig)

    print(fig.get_size_inches())

    plt.savefig(&#39;figures/Fern_&#39; + thetaStrsFile[i] + &#39;.png&#39;, bbox_inches = &#39;tight&#39;, dpi = 300)
    plt.savefig(&#39;figures/Fern_&#39; + thetaStrsFile[i] + &#39;.eps&#39;, bbox_inches = &#39;tight&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.7853981633974483
1.8
[7.54478873 1.8       ]
2.356194490192345
1.8
[7.54478873 1.8       ]
4.71238898038469
1.8
[7.54478873 1.8       ]
5.497787143782138
1.8
[7.54478873 1.8       ]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_24_1.png" src="../_images/notebooks_CodingFiguresFern_24_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_24_2.png" src="../_images/notebooks_CodingFiguresFern_24_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_24_3.png" src="../_images/notebooks_CodingFiguresFern_24_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_24_4.png" src="../_images/notebooks_CodingFiguresFern_24_4.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig,ax = plt.subplots()
plt.colorbar(im,ax=ax)

ax.remove()
fig.set_figwidth(0.8)
plt.savefig(&#39;figures/OnlyColorbar.png&#39;, bbox_inches = &#39;tight&#39;, dpi = 300)
plt.savefig(&#39;figures/OnlyColorbar.eps&#39;, bbox_inches = &#39;tight&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_25_0.png" src="../_images/notebooks_CodingFiguresFern_25_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>str(int(theta*1000))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;5497&#39;
</pre></div></div>
</div>
</section>
<section id="Thresholded-Figure">
<h2>Thresholded Figure<a class="headerlink" href="#Thresholded-Figure" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def makeFernPicThreshold(F, theta, thresh, both = False):
    maxRow, maxCol = np.shape(F)
    omega = (np.cos(theta), np.sin(theta))

    # center origin
    Col,Row = np.meshgrid(range(maxCol),range(maxRow))
    Col = Col - np.floor(maxCol/2)
    Row = Row-np.floor(maxRow/2)

    fMask = omega[0]*Col + omega[1]*Row

    fMaskBelow = fMask.copy()
    fMaskBelow[fMaskBelow &lt;= thresh] = np.nan

    fMaskAbove = fMask.copy()
    fMaskAbove[fMaskAbove &gt; thresh] = np.nan


    DTdown = np.multiply(F,fMaskAbove)
    DTup = np.multiply(F,fMaskBelow)

    # Why the fork is this backwards!?!?!?!?!
    # Must have something to do with meshgrid but i just can&#39;t fight it right now
    if both:

        return DTdown,DTup
    else:
        return DTdown
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>theta = 3*np.pi/4

for thresh in [-150,-100,-50,0,50,100,150]:


    heights = np.sum(leaf.cells[0]*omega, axis=1)

    # Plot colors above theshold
    plt.matshow(makeFernPicThreshold(F,theta,thresh),
                origin = &#39;lower&#39;,
                cmap = cmap_viridis,
                vmin = -200, vmax = 200)

    ax = plt.gca()
    midx = 279
    ax.set_xticks(midx+100*np.arange(-2,3))
    ax.set_xticklabels(np.arange(-2,3)*100)
    ax.xaxis.set_ticks_position(&#39;bottom&#39;)
    ax.tick_params(axis=&#39;x&#39;, labelrotation=45)


    midy = 177
    ax.set_yticks(midy+100*np.arange(-2,3))
    ax.set_yticklabels(np.arange(-2,3)*100)

    plt.title(r&#39;$K_{&#39; + str(thresh) + r&#39;}$&#39;)

    fig = plt.gcf()
    fig.set_figwidth(1.25)

    thresh_size_fig = fig.get_size_inches()
    print(thresh_size_fig)

    # plt.colorbar()

    plt.savefig(&#39;figures/Fern_3pi_over_4_Thresh&#39;+str(thresh)+&#39;.png&#39;, bbox_inches = &#39;tight&#39;,dpi = 300)
    plt.savefig(&#39;figures/Fern_3pi_over_4_Thresh&#39;+str(thresh)+&#39;.eps&#39;, bbox_inches = &#39;tight&#39;)

    # plt.clf()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1.25 4.8 ]
[1.25 4.8 ]
[1.25 4.8 ]
[1.25 4.8 ]
[1.25 4.8 ]
[1.25 4.8 ]
[1.25 4.8 ]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_30_1.png" src="../_images/notebooks_CodingFiguresFern_30_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_30_2.png" src="../_images/notebooks_CodingFiguresFern_30_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_30_3.png" src="../_images/notebooks_CodingFiguresFern_30_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_30_4.png" src="../_images/notebooks_CodingFiguresFern_30_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_30_5.png" src="../_images/notebooks_CodingFiguresFern_30_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_30_6.png" src="../_images/notebooks_CodingFiguresFern_30_6.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_30_7.png" src="../_images/notebooks_CodingFiguresFern_30_7.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>theta = 3*np.pi/4

fig,axes = plt.subplots(1,5,sharey = True, figsize = (6,2))

for i, thresh in enumerate([-150,-50,0,50,150]):

    ax = axes[i]

    heights = np.sum(leaf.cells[0]*omega, axis=1)

    # Plot colors above theshold
    ax.matshow(makeFernPicThreshold(F,theta,thresh),
                origin = &#39;lower&#39;,
                cmap = cmap_viridis,
                vmin = -200, vmax = 200)

    # midx = 279
    # ax.set_xticks(midx+100*np.arange(-2,3))
    # ax.set_xticklabels(np.arange(-2,3)*100)
    # ax.xaxis.set_ticks_position(&#39;bottom&#39;)
    # ax.tick_params(axis=&#39;x&#39;, labelrotation=45)


    # midy = 177
    # ax.set_yticks(midy+100*np.arange(-2,3))
    # ax.set_yticklabels(np.arange(-2,3)*100)

    ax.set_xticks([])
    ax.set_yticks([])
    ax.set_title(r&#39;$K_{&#39; + str(thresh) + r&#39;}$&#39;)

    # fig = plt.gcf()
    # fig.set_figwidth(1.25)

    # thresh_size_fig = fig.get_size_inches()
    # print(thresh_size_fig)

    # plt.colorbar()

    # plt.savefig(&#39;figures/Fern_3pi_over_4_Thresh&#39;+str(thresh)+&#39;.png&#39;, bbox_inches = &#39;tight&#39;,dpi = 300)
    # plt.savefig(&#39;figures/Fern_3pi_over_4_Thresh&#39;+str(thresh)+&#39;.eps&#39;, bbox_inches = &#39;tight&#39;)

    # plt.clf()
plt.savefig(&#39;figures/Fern_3pi_over_4_AllThresh.png&#39;, bbox_inches = &#39;tight&#39;,dpi = 300)
plt.savefig(&#39;figures/Fern_3pi_over_4_AllThresh.eps&#39;, bbox_inches = &#39;tight&#39;,dpi = 300)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_31_0.png" src="../_images/notebooks_CodingFiguresFern_31_0.png" />
</div>
</div>
</section>
<section id="ECC-in-one-direction">
<h2>ECC in one direction<a class="headerlink" href="#ECC-in-one-direction" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>theta = 3*np.pi/4
omega = (np.cos(theta), np.sin(theta))
heights = np.sum(leaf.cells[0]*omega, axis=1)
numThresh = 64

threshes= np.linspace(heights.min(), heights.max(), numThresh)

outECC = leaf.ECC(heights, numThresh)

fig = plt.figure()
ax = plt.gca()

positions = [-150, -50, 0, 50, 150]
for pos in positions:
    ax.axvline(x=pos, color=&#39;grey&#39;, linestyle=&#39;--&#39;)



plt.step(threshes,outECC)
plt.title(r&#39;ECC for $\omega = \frac{3 \pi}{4}$&#39;)
plt.xlabel(&#39;$a$&#39;)
plt.ylabel(r&#39;$\chi(K_a)$&#39;)

# ax.set_xticks([-200,-150,-100,-50,0,50,100,150,200])
    # midx = 279
    # ax.set_xticks(midx+100*np.arange(-2,3))
    # ax.set_xticklabels(np.arange(-2,3)*100)
    # ax.xaxis.set_ticks_position(&#39;bottom&#39;)
    # ax.tick_params(axis=&#39;x&#39;, labelrotation=45)
ax.tick_params(axis=&#39;x&#39;, labelrotation=45)
ax.tick_params(axis=&#39;y&#39;, labelrotation=45)







fig = plt.gcf()
fig.set_size_inches(5,2)
# fig.set_size_inches(thresh_size_fig)
# print(thresh_size_fig)
# print(fig.get_size_inches())

plt.savefig(&#39;figures/Fern_3pi_over_4_ECC.png&#39;, bbox_inches = &#39;tight&#39;,dpi=300)
plt.savefig(&#39;figures/Fern_3pi_over_4_ECC.eps&#39;, bbox_inches = &#39;tight&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_33_0.png" src="../_images/notebooks_CodingFiguresFern_33_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(outECC[-1])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-197
</pre></div></div>
</div>
</section>
<section id="ECT">
<h2>ECT<a class="headerlink" href="#ECT" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Get all the directions around the circle
numCircleDirs = 32
circledirs =  np.linspace(0, 2*np.pi, num=numCircleDirs, endpoint=False)
circledirs

print(circledirs/np.pi)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.     0.0625 0.125  0.1875 0.25   0.3125 0.375  0.4375 0.5    0.5625
 0.625  0.6875 0.75   0.8125 0.875  0.9375 1.     1.0625 1.125  1.1875
 1.25   1.3125 1.375  1.4375 1.5    1.5625 1.625  1.6875 1.75   1.8125
 1.875  1.9375]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Choose number of thresholds for the ECC to stop at
numThresh = 100
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ECT_preprocess = {}

overallmin = 0
overallmax = 0

for i, omega in enumerate(circledirs):

    omegavec = np.array((np.cos(omega),np.sin(omega)))

    # Function values of all the pixels
    heights = np.sum(leaf.cells[0]*omegavec, axis=1)

    # Thresholds implicitly calculated by Erik&#39;s code
    threshes= np.linspace(heights.min(), heights.max(), numThresh)

    if heights.min()&lt;overallmin:
        overallmin = heights.min()
    if heights.max()&gt;overallmax:
        overallmax= heights.max()


    outECC = leaf.ECC(heights, numThresh)

    ECT_preprocess[i] = (threshes,outECC)

print(overallmin,overallmax)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-285.68893688291087 285.68893688291087
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>i = 2

plt.step( ECT_preprocess[i][0],  ECT_preprocess[i][1])
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x73f16b12de10&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_39_1.png" src="../_images/notebooks_CodingFiguresFern_39_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Making a matrix of size numThreshes x numCircleDirs
# M[i,j] =


# Make meshgrid. The +1 is to draw 2pi on both ends
X,Y = np.meshgrid(range(numCircleDirs+1),np.linspace(-250,250,numThresh))
M = np.ones_like(X)

for i in range(X.shape[0]):
    for j in range(X.shape[1]):
        omegai = X[i,j]

        # Deal with redrawing the 2pi
        omegai = np.mod(omegai,numCircleDirs)


        omega = i*np.pi/numCircleDirs
        a = Y[i,j]
        threshes = ECT_preprocess[omegai][0]
#         print(threshes)
        try:
            index = np.where(threshes&gt;=a)[0][0]
        except:
            index = [-1]

        M[i,j] = ECT_preprocess[omegai][1][index]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/tmp/ipykernel_57600/1470381530.py:26: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  M[i,j] = ECT_preprocess[omegai][1][index]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.pcolormesh(X,Y,M, cmap = &#39;viridis&#39;)
plt.colorbar()

ax = plt.gca()
ax.set_xticks(np.arange(0,numCircleDirs+1,4))

labels = [r&#39;$0$&#39;,
          r&#39;$\frac{\pi}{4}$&#39;,
          r&#39;$\frac{\pi}{2}$&#39;,
          r&#39;$\frac{3\pi}{4}$&#39;,
          r&#39;$\pi$&#39;,
          r&#39;$\frac{5\pi}{4}$&#39;,
          r&#39;$\frac{3\pi}{2}$&#39;,
          r&#39;$\frac{7\pi}{4}$&#39;,
          r&#39;$2\pi$&#39;,
         ]

ax.set_xticklabels(labels)


plt.xlabel(r&#39;$\omega$&#39;)
plt.ylabel(r&#39;$a$&#39;)

plt.title(r&#39;ECT of Fern Leaf&#39;)
fig = plt.gcf()
fig.set_size_inches(3,2)

plt.savefig(&#39;figures/Fern_ECT.png&#39;, bbox_inches = &#39;tight&#39;,dpi=900)
plt.savefig(&#39;figures/Fern_ECT.eps&#39;, bbox_inches = &#39;tight&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_41_0.png" src="../_images/notebooks_CodingFiguresFern_41_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>M[0,:]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 1,  1,  1,  1,  6,  1,  1,  1,  1,  2,  1,  4,  1,  1,  3,  3,  2,
        1,  2, 10,  3,  3,  1,  1,  3,  3,  1,  2,  1,  1,  1,  1,  1])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>bigvals = np.where(M[0,:] &gt;3)[0]


circledirs[bigvals]/np.pi*16
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 4., 11., 19.])
</pre></div></div>
</div>
</section>
<section id="Let's-draw-a-cylinder!">
<h2>Let‚Äôs draw a cylinder!<a class="headerlink" href="#Let's-draw-a-cylinder!" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib
from mpl_toolkits.mplot3d import Axes3D
import numpy as np
import matplotlib.pyplot as plt

# pip install ipympl

# %matplotlib widget
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>grid = M[:,:-1]
print(grid.shape)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(100, 32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>color_dimension = grid # change to desired fourth dimension
minn, maxx = color_dimension.min(), color_dimension.max()
norm = matplotlib.colors.Normalize(minn, maxx)
m = plt.cm.ScalarMappable(norm=norm, cmap=&#39;viridis&#39;)
m.set_array([])
fcolors = m.to_rgba(color_dimension)

print(fcolors.shape)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(100, 32, 4)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>theta = np.linspace(0, 2 * np.pi, 24)
print(theta)
# theta = circledirs[:-1]
# print(theta, theta.shape)
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.         0.27318197 0.54636394 0.81954591 1.09272788 1.36590985
 1.63909182 1.91227379 2.18545576 2.45863773 2.7318197  3.00500167
 3.27818364 3.55136561 3.82454758 4.09772955 4.37091152 4.64409349
 4.91727546 5.19045743 5.4636394  5.73682137 6.01000334 6.28318531]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>&quot;&quot;&quot;
equation for a circle

x  =  h + r cosŒ∏
y  =  k + r sinŒ∏

where h and k are the co-ordinates of the center

0 &lt;= Œ∏ &lt;= 360
&quot;&quot;&quot;

fig = plt.figure(figsize=(4,3))
ax = fig.add_subplot(111, projection=&#39;3d&#39;)

# theta = np.linspace(0, 2 * np.pi, 24)
radius = 1


x = np.linspace(0, numThresh, numThresh)

# theta = circledirs
theta = np.linspace(0, 2 * np.pi, 32)

thetas, xs = np.meshgrid(theta, x)

y = radius * np.cos(thetas)
z = radius * np.sin(thetas)

#ax.plot_surface(xs, y, z, color=&#39;orange&#39;)
#ax.plot_surface(xs, y, z, facecolors=fcolors)
surf = ax.plot_surface(xs, y, z, facecolors = fcolors,linewidth = 0.1)
surf.set_edgecolor(&#39;grey&#39;)

ax.set_axis_off()

plt.savefig(&#39;figures/fern_ECT_cylinder.png&#39;, bbox_inches = &#39;tight&#39;,dpi = 900)
plt.savefig(&#39;figures/fern_ECT_cylinder.eps&#39;, bbox_inches = &#39;tight&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_49_0.png" src="../_images/notebooks_CodingFiguresFern_49_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>omegai = 5
omega = i*np.pi/numCircleDirs
a = 17
threshes = ECT_preprocess[omegai][0]
print(threshes)

index = np.where(threshes&gt;=a)[0][0]
print(index)
print(threshes[index])
ECT_preprocess[omegai][1][index]
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[-193.98518858 -190.40235323 -186.81951788 -183.23668253 -179.65384718
 -176.07101183 -172.48817648 -168.90534113 -165.32250578 -161.73967042
 -158.15683507 -154.57399972 -150.99116437 -147.40832902 -143.82549367
 -140.24265832 -136.65982297 -133.07698762 -129.49415227 -125.91131692
 -122.32848157 -118.74564621 -115.16281086 -111.57997551 -107.99714016
 -104.41430481 -100.83146946  -97.24863411  -93.66579876  -90.08296341
  -86.50012806  -82.91729271  -79.33445735  -75.751622    -72.16878665
  -68.5859513   -65.00311595  -61.4202806   -57.83744525  -54.2546099
  -50.67177455  -47.0889392   -43.50610385  -39.92326849  -36.34043314
  -32.75759779  -29.17476244  -25.59192709  -22.00909174  -18.42625639
  -14.84342104  -11.26058569   -7.67775034   -4.09491499   -0.51207963
    3.07075572    6.65359107   10.23642642   13.81926177   17.40209712
   20.98493247   24.56776782   28.15060317   31.73343852   35.31627387
   38.89910923   42.48194458   46.06477993   49.64761528   53.23045063
   56.81328598   60.39612133   63.97895668   67.56179203   71.14462738
   74.72746273   78.31029808   81.89313344   85.47596879   89.05880414
   92.64163949   96.22447484   99.80731019  103.39014554  106.97298089
  110.55581624  114.13865159  117.72148694  121.3043223   124.88715765
  128.469993    132.05282835  135.6356637   139.21849905  142.8013344
  146.38416975  149.9670051   153.54984045  157.1326758   160.71551116]
59
17.402097119801482
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-83
</pre></div></div>
</div>
</section>
<section id="Erik's-version">
<h2>Erik‚Äôs version<a class="headerlink" href="#Erik's-version" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># t = 32
# tic = time.perf_counter()
# ect = leaf.ECT(circle_dirs, T=t)
# toc = time.perf_counter()
# print(&quot;Complex with {} vertices\n&quot;.format(len(leaf.cells[0])))
# print(&quot;ECT with {} directions in {:.4f} seconds.\n{:.4f}s per direction&quot;.format(len(circle_dirs), toc-tic, (toc-tic)/len(circle_dirs)))

# plt.figure(figsize=(15,2))
# plt.plot(ect);
# plt.title(&#39;ECT for {} directions and {} thresholds each&#39;.format(len(circle_dirs),t), fontsize=24);
</pre></div>
</div>
</div>
</section>
</section>
<section id="SECT">
<h1>SECT<a class="headerlink" href="#SECT" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># THe original ECT

plt.pcolormesh(X,Y,M, cmap = &#39;viridis&#39;)
plt.colorbar()

ax = plt.gca()
ax.set_xticks(np.arange(0,numCircleDirs+1,4))

labels = [r&#39;$0$&#39;,
          r&#39;$\frac{\pi}{4}$&#39;,
          r&#39;$\frac{\pi}{2}$&#39;,
          r&#39;$\frac{3\pi}{4}$&#39;,
          r&#39;$\pi$&#39;,
          r&#39;$\frac{5\pi}{4}$&#39;,
          r&#39;$\frac{3\pi}{2}$&#39;,
          r&#39;$\frac{7\pi}{4}$&#39;,
          r&#39;$2\pi$&#39;,
         ]

ax.set_xticklabels(labels)

fig = plt.gcf()
fig.set_size_inches(3,2)
plt.xlabel(r&#39;$\omega$&#39;)
plt.ylabel(r&#39;$a$&#39;)

plt.title(r&#39;ECT of Fern Leaf&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;ECT of Fern Leaf&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_54_1.png" src="../_images/notebooks_CodingFiguresFern_54_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Following Crawford2019 for the moment. Is this different in the Meng22 version?
print(M.shape)

# Averages for a fixed direction
AvgOverOmega = np.average(M,axis = 0)
print(AvgOverOmega)

# Mean centered

Mcentered = M-AvgOverOmega
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(100, 33)
[-100.72  -99.01  -96.97  -95.    -93.24  -92.33  -91.34  -90.83  -90.69
  -89.07  -87.98  -87.07  -87.2   -87.64  -88.43  -89.47  -90.97  -90.94
  -91.8   -91.22  -93.    -94.51  -96.85  -98.61  -99.98 -100.05 -100.44
 -100.47 -101.04 -101.12 -101.03 -100.91 -100.72]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.pcolormesh(X,Y,Mcentered, cmap = &#39;viridis&#39;)
plt.colorbar()

ax = plt.gca()
ax.set_xticks(np.arange(0,numCircleDirs+1,4))

labels = [r&#39;$0$&#39;,
          r&#39;$\frac{\pi}{4}$&#39;,
          r&#39;$\frac{\pi}{2}$&#39;,
          r&#39;$\frac{3\pi}{4}$&#39;,
          r&#39;$\pi$&#39;,
          r&#39;$\frac{5\pi}{4}$&#39;,
          r&#39;$\frac{3\pi}{2}$&#39;,
          r&#39;$\frac{7\pi}{4}$&#39;,
          r&#39;$2\pi$&#39;,
         ]

ax.set_xticklabels(labels)


plt.xlabel(r&#39;$\omega$&#39;)
plt.ylabel(r&#39;$a$&#39;)

plt.title(r&#39;ECT of Fern Leaf with value centered&#39;)

fig = plt.gcf()
fig.set_size_inches(3,2)

plt.savefig(&#39;figures/Fern-ECT-centered.png&#39;, bbox_inches = &#39;tight&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_56_0.png" src="../_images/notebooks_CodingFiguresFern_56_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>Mcentered.sum(axis = 0)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-1.09992015e-11,  1.23066002e-11, -1.07718279e-11,  0.00000000e+00,
       -1.27613475e-11, -5.48538992e-12,  6.96331881e-12, -5.03064257e-12,
        4.71800377e-12,  7.78754838e-12,  1.33582034e-12,  7.78754838e-12,
       -9.12336873e-12, -5.42854650e-12, -7.56017471e-12, -1.09992015e-11,
       -1.09992015e-11,  4.71800377e-12,  9.35074240e-12, -1.09992015e-11,
        0.00000000e+00,  1.25339739e-11, -6.56541488e-12,  5.54223334e-12,
        1.33582034e-12,  9.40758582e-12,  4.66116035e-12, -1.09992015e-11,
       -2.87059265e-12, -8.29913915e-12,  1.07718279e-11, -7.53175300e-12,
       -1.09992015e-11])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>a = np.array([[1,2,3], [4,5,6]])
print(a)
np.cumsum(a,axis = 0)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1 2 3]
 [4 5 6]]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1, 2, 3],
       [5, 7, 9]])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>Mint = np.cumsum(Mcentered,axis = 0)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.pcolormesh(X,Y,Mint, cmap = &#39;viridis&#39;)
plt.colorbar()

ax = plt.gca()
ax.set_xticks(np.arange(0,numCircleDirs+1,4))

labels = [r&#39;$0$&#39;,
          r&#39;$\frac{\pi}{4}$&#39;,
          r&#39;$\frac{\pi}{2}$&#39;,
          r&#39;$\frac{3\pi}{4}$&#39;,
          r&#39;$\pi$&#39;,
          r&#39;$\frac{5\pi}{4}$&#39;,
          r&#39;$\frac{3\pi}{2}$&#39;,
          r&#39;$\frac{7\pi}{4}$&#39;,
          r&#39;$2\pi$&#39;,
         ]

ax.set_xticklabels(labels)


fig = plt.gcf()
fig.set_size_inches(3,2)

plt.xlabel(r&#39;$\omega$&#39;)
plt.ylabel(r&#39;$t$&#39;)

plt.title(r&#39;SECT of Fern Leaf&#39;)

plt.savefig(&#39;figures/Fern-SECT.png&#39;,bbox_inches = &#39;tight&#39;,dpi=900)
plt.savefig(&#39;figures/Fern-SECT.eps&#39;,bbox_inches = &#39;tight&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_CodingFiguresFern_60_0.png" src="../_images/notebooks_CodingFiguresFern_60_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, MunchLab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>